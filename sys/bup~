#!/bin/sh
# Backups impromptus conservant les chemins absolus
# Récupération avec : tar -xzvf <archive>.tar.gz

TARGET="$1"
BDIR="$HOME/Documents/Backups/6-ponctuels"
mkdir -p "$BDIR"

NAME="$(basename "${TARGET}"| sed 's/\.[^.]*$//')"
TIMESTAMP="$(date +%Y-%m-%d_%H%M-%S)"
BACKUP_NAME="${NAME}_${TIMESTAMP}.tar.gz"

# Création de l'archive, conservant les chemins absolus
tar -zcvf "$BDIR/$BACKUP_NAME" "${TARGET}" -P && \
   echo "[$(date +%H:%M:%S)] Backup @ $BDIR/$BACKUP_NAME" && \
   notify-send "[$(date +%H:%M:%S)] Backup @ $BDIR/$BACKUP_NAME"
